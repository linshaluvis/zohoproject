{% extends 'base.html' %}
{% block content %}
{% load static %}
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E="
crossorigin="anonymous"></script>
<style>
    .search-dropdown-container {
        display: inline-block;
    }

    .search-dropdown {
        width: 200px;
        padding: 8px 12px;
        border: 1px solid #ced4da;
        border-radius: 4px;
        background-color: #fff;
        outline: none;
        transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }

    .search-dropdown:focus {
        border-color: #80bdff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }
    /* Style for the close button */
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }

  /* Hover effect for the close button */
  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }
  .quantity-input-container {
    position: relative;
    display: inline-block;
  }

  /* Style for the quantity input box */
  .quantity-input {
    width: 50px;
    text-align: center;
    padding-right: 20px; /* Make space for the up/down arrows */
  }

  /* Style for the up and down arrow buttons */
  .quantity-arrow {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    width: 20px;
    cursor: pointer;
  }
  .popup-0 {
    height: 17rem;
    width: 20rem;
    background-color: rgb(3, 3, 3);
    border-radius: 1rem;
    position: absolute;
    margin-bottom:70rem;
    left: 0%;
    transform: translate(-50%, -50%)scale(0.1);
    text-align: center;
    padding: 0 5rem 5 rem;
    color: black;
    
    visibility: hidden;
    transform: translate(-50%, -50%)scale(0.1);

  }

  .open-popup-3 {
    margin-top: -30rem;
    visibility: visible;
    transform: translate(-50%, -50%)scale(1);
    transition: transform 0.4s, top 0.4s;
    margin-left: 40rem;
  background-color: #000;
  }
  .modal{
    width: 100%;


  }
 
        
    
      .modal-container {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.4);
      }
      
      .modal-content {
        background-color: #fefefe;
        margin: 5% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 100%;
      }
      
     

  
   
</style>


<div class="body-wrapper">
    <div class="container-fluid">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="" class="text-warning-emphasis">Dashboard</a></li>
              <li class="breadcrumb-item"><a href="" class="text-warning-emphasis">sales</a></li>
              <li class="breadcrumb-item" aria-current="page">invoice</li>
            </ol>
        </nav>

        <div class="row mt-3">
            <div class="container">
                
            </div>
        </div>
        <div class="row mt-3">
            <div class="container">
                <h4 class="text-white ms-4">New Invoice</h4>
                <hr class="text-warning">
            </div>
        </div>
        <div class="row g-0 mt-2 mt-lg-3">
            <div class="col-md-6">
                <div class="card-body ">
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white">Customer Name : </p>

                        </div>
                        <div class="col-md-6 d-flex align-items-center">
                            <div class="search-dropdown-container">
                                <input type="text" id="searchDropdown" class="search-dropdown" placeholder="Search or select...">
                                
                                <ul class="dropdown-menu" id="dropdownMenu" >
                                    {% for c in customers %}

			                        <a class="dropdown-item" onchange="updatePlace()" value="{{ c.id }}" data-name="{{ c.first_name }}" data-email="{{ c.customer_email }}" data-gstno="{{c.GST_number}}" data-place="{{c.place_of_supply}}"  data-billingcountry="{{c.billing_country}}"data-billingstate="{{c.billing_state}}" data-billingcity="{{c.billing_city}}" data-billing="{{c.billing_address}}" data-gst="{{c.GST_treatement}}"data-phone="{{ c.customer_phone }}"href="">{{c.first_name}}</a>

			                        {% endfor %}

			 
                                </ul>
                            </div>
                            <a class="btn btn-outline-warning ml-2" data-bs-toggle="modal" data-bs-target="#createcustomer" ID="open-modal-btn" onclick="openModal2" href="" role="button">+</a>
                        </div>
                    </div>
                    
                 

<!-- Other fields can be added here -->

<script>document.addEventListener('DOMContentLoaded', function() {
    var dropdownMenu = document.getElementById('dropdownMenu');
    dropdownMenu.addEventListener('click', function(event) {
        var target = event.target;
        if (target.classList.contains('dropdown-item')) {
            event.preventDefault();

            document.getElementById('searchDropdown').value = target.dataset.name;
            document.getElementById('customerEmail').value = target.dataset.email;
            document.getElementById('customerPhone').value = target.dataset.phone;
            document.getElementById('customergst').value = target.dataset.gst;
            document.getElementById('customergstno').value = target.dataset.gstno;
            document.getElementById('customerplace').value = target.dataset.place;


           


            var combinedValues = target.dataset.billing + '\n' + target.dataset.billingcity + '\n' + target.dataset.billingstate + '\n' + target.dataset.billingcountry;

            document.getElementById('combinedValuesTextarea').value = combinedValues;

            var inputValue = target.dataset.place;

            var dropdown = document.getElementById('customerplace');


            var option = document.createElement('option');

            option.value = inputValue;
            option.text = inputValue;
            alert(inputValue)



            dropdown.appendChild(option);

            option.selected = true;
            alert("ok")
            

                
    // Function to show or hide the second dropdown based on the selected value in the first dropdown
// Function to show or hide the second dropdown based on the selected value in the first dropdown
function toggleSecondDropdown() {
    var customerplaceDropdown = document.getElementById('customerplace');
    var gstPercentageDropdown = document.getElementById('gstPercentageDropdown');
    var otherDropdown = document.getElementById('otherDropdown');

  
    var selectedValue = customerplaceDropdown.value.toLowerCase();
    alert(selectedValue)

  
    if (selectedValue === 'kerala') {
      gstPercentageDropdown.style.display = 'block';
      otherDropdown.style.display = 'none';
      $('#cgst').val(parseFloat(gst.toFixed(2)));
            $('#sgst').val(parseFloat(gst.toFixed(2)));
            $('#igst').val(parseFloat(d.toFixed(2)));
            // document.getElementById('tr_cgst').style= ('display: flex');
            
            // document.getElementById('tr_sgst').style= ('display: flex');
            // document.getElementById('tr_igst').style= ('display: none');

    } else {
      gstPercentageDropdown.style.display = 'none';
      otherDropdown.style.display = 'block';
      $('#igst').val(taxamount.toFixed(2));
      $('#cgst').val(d.toFixed(2));
      $('#sgst').val(d.toFixed(2));
      document.getElementById('cgst')= ('display: none');
      document.getElementById('sgst')= ('display: none');
      document.getElementById('igst')= ('display: block');
    }
  }
  
  // Event listener to toggle the second dropdown when the first dropdown value changes
  document.getElementById('customerplace').addEventListener('change', toggleSecondDropdown);
  
  // Initial call to toggleSecondDropdown to set the initial state based on the initial value of the first dropdown
  toggleSecondDropdown();
                
                }
            });
        });



</script>
<!-- First dropdown -->

  
  <!-- Second dropdown (initially hidden) -->
 
 
  

                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white" for="customerEmail">Customer Email ID</p>

                        </div>
                        <div class="col-md-6">
                            <input type="text" id="customerEmail" name="customerEmail" readonly class="form-control text-white" >
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white" for="customerPhone">Customer contact number</p>

                        </div>
                        <div class="col-md-6">
                            <input type="text" id="customerPhone" name="customerPhone" readonly class="form-control text-white" >
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white" for="combinedValuesTextarea" >Billing Address</p>

                        </div>
                        <div class="col-md-6">
                            <textarea class="form-control text-white" id="combinedValuesTextarea" rows="6" cols="40"></textarea>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white" for="customergst">GST Treatment</p>

                        </div>
                        <div class="col-md-6">
                            <input type="text" id="customergst" name="customergst" readonly class="form-control text-white" >
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white" for="customergstno">GST Number</p>

                        </div>
                        <div class="col-md-6">
                            <input type="text" id="customergstno" name="customergstno" readonly class="form-control text-white" >
                        </div>
                    </div>
                </div></div>
                   
            
            <div class="col-md-6">
                <div class="card-body ">
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white"> number </p>

                        </div>
                        <div class="col-md-6">
                            <input type="text" id="fname" name="fname" class="form-control text-white" >
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white">Reference number</p>

                        </div>
                        <div class="col-md-8">
                            <h5 class="text-white">: </h5>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white" for="customerplace">place of supply</p>

                        </div>
                       
                        <div class="col-md-6">
                            <select type="text" class="form-select rounded bg-black text-white" id="customerplace" name="customerplace">
                                <option value="" hidden></option>
                                <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option> <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
                                <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> <option value="volvo">[AS]-Assam</option>
                                <option value="[BR]-Bihar">[BR]-Bihar</option> <option value="volvo">[CH]-	Chandhigarh</option><option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                                <option value="[DD]-Daman Diu">[DD]-Daman Diu</option><option value="volvo">[DL]-	Delhi</option><option value="[GA]-Goa">[GA]-Goa</option> <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                                <option value="[HR]-Haryana">[HR]-Haryana</option> <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
                                <option value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option><option value="[JH]-Jharkand">[JH]-Jharkand</option>
                                <option value="[KA]-Karnataka">[KA]-Karnataka</option><option value="[KL]-Kerala">[KL]-Kerala</option>
                                <option value="[LA]-Ladakh">[LA]-Ladakh</option><option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                                <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option><option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                                <option value="[MN]-Manipur">[MN]-Manipur</option>  <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                                <option value="[MZ]-Mizoram">[MZ]-Mizoram</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                                <option value="[OD]-Odisha">[OD]-Odisha</option><option value="[PY]-Puducherry">[PY]-Puducherry</option>
                                <option value="[PB]-Punjab">[PB]-Punjab.</option><option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                                <option value="[SK]-Sikkim">[SK]-Sikkim</option><option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                                <option value="[TS]-Telenghana">[TS]-Telenghana</option><option value="[TR]-Tripura">[TR]-Tripura</option><option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                                <option value="[UK]-Utharakhand">[UK]-Utharakhand</option><option value="[WB]-West Bengal">[WB]-West Bengal</option>
                                <option value="[OT]-Other Territory">[OT]-Other Territory</option>
                            </select>
                        </div>
                    </div>
                     
<script>
  
    
  </script>
                   
                   
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <p class="text-white">Payment method</p>

                        </div>
                        <div class="col-md-6">
                      
                    <select  id="paymentMethod" onchange="showPaymentDetails()"class="form-select rounded bg-black text-white">
                        <option class="dropdown-item" value="Cash">Cash</option>
                        <option class="dropdown-item" value="Cheque">Cheque</option>
                        <option class="dropdown-item" value="UPI">UPI</option>
                        <option  class="dropdown-item" value="Bank">Bank</option>
                    </select>
                </div>
            </div>
            <div id="chequeDetails" style="display:none;">
                <div class="row mt-2">
                    <div class="col-md-4">
                        <label for="chequeNumber" class="text-white">Cheque Number:</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" id="chequeNumber" name="chequeNumber" class="form-control text-white">
                    </div>
                </div>
            </div>
                
                   
                    
                
                    <div  id="upiDetails" style="display:none;">
                        <div class="row mt-2">

                        <div class="col-md-4">
                            
                            <p class="text-white" for="upiId" >UPI ID:</p>

                        </div>

                        <div class="col-md-6"  style="display: inline;">
                            <input type="text" id="upiId" name="upiId"  class="form-control text-white" >
                        </div>
                    </div>
                </div>
                
                    <div id="bankDetails" style="display:none;">
                        <div class="row mt-2">
                            <div class="col-md-4">
                                <label for="bankAccountNumber" class="text-white">Bank Account Number:</label>
                            </div>
                            <div class="col-md-6">
                                <input type="text" id="bankAccountNumber" name="bankAccountNumber" class="form-control text-white">
                            </div>
                        </div>
                    </div>
                </div></div>
                
                    <script>
                        function showPaymentDetails() {
                            var paymentMethod = document.getElementById("paymentMethod").value;
                            var chequeDetails = document.getElementById("chequeDetails");
                            var upiDetails = document.getElementById("upiDetails");
                            var bankDetails = document.getElementById("bankDetails");
                
                            // Hide all payment details fields initially
                            chequeDetails.style.display = "none";
                            upiDetails.style.display = "none";
                            bankDetails.style.display = "none";

                            
                
                            // Show the appropriate payment details field based on the selected payment method
                            if (paymentMethod === "Cheque") {
                                chequeDetails.style.display = "block";

                            } else if (paymentMethod === "UPI") {
                                upiDetails.style.display = "block";
                            } else if (paymentMethod === "Bank") {
                                // Here, you would autofill the bank account number based on the selected bank
                                bankDetails.style.display = "block";
                            }
                        }
                    </script>
                 
               
                   
                                                
                
    
          
        </div>
         <div class="row mt-2">
                        
                    <div class="row mb-4">
                      <div class="col-sm-2  text-white"><label for="estimate_number">Invoice number</label></div>
                      <div class="col-sm-6"><input type="text" class="form-control text-white" id="estimate_number" name="inv_no" value="INV-00{{count}}">
                         
                      </div>
                  </div>
                  <div class="row mb-4">
                      <div class="col-sm-2  text-white"><label for="reference">Order Number</label></div>
                      <div class="col-sm-6 text-white"> <input type="text" class="form-control text-dark" id="ord_no" name="ord_no" class="" required>
                              </div>
                  </div>
                  <div class="row mb-6 ">
                    <div class="col-sm-6 col-lg-2 col-md-2">
                      <label class="mr-3  text-white " for="input-1">invoice Date</label>
                    </div>
                    <div class="col-sm-6  col-lg-2 col-md-2">
                      <input type="date" class="form-control text-white"   name="inv_date" id="input-1" >
                    </div>
                    
                        
                    <div class="col-sm-6 col-md-2 col-lg-2">
                      <label for="input-2" class="ms-5  text-white">Due Date</label>
                  </div>
                  <div class="col-sm-6 col-lg-2 col-md-2">
                      <input type="date" class="form-control text-white" name="due_date" id="input-2" readonly>
                  </div>
                  <div class="row mb-6 border-bottom pb-5">
                    <div class="col-sm-2  text-white">
                      <label for="input-2">Terms</label>
                    
                    </div>
      
      
                    
                    <div class="col-sm-6 ">
                      <select class="my-select form-control text-white" name="term" id="inv_term">
                    {% for p in payments %}
                      <option  class="dropdown-item text-dark" value="{{p.days}}">{{ p.term_name }}</option>
                      {% endfor%}
                        </select> 
                       
                      </div>
                      <div class="col-sm-4">
                        <a href="#" data-target="#newpayment" data-toggle="modal">
                            <i class="fa-solid fa fa-plus p-2 rounded" style="color: white; background-color: rgb(210, 132, 30); height: 37px;"></i>
                        </a>
                    </div>
                    <div class="col-sm-8">
                      <p id="alertMessage" style="color: red; font-style: italic;"></p> <!-- Element to display the alert -->
                    </div>
                    
                    <script>
                      function calculateDueDate() {
                        const invoiceDate = new Date(document.getElementById('input-1').value);
                        const paymentTerm = document.getElementById('inv_term').value;
                        const dueDateField = document.getElementById('input-2');
                        const alertElement = document.getElementById('alertMessage');
                    
                        if (paymentTerm === "recpt") {
                          // Due on receipt, no additional days
                          dueDateField.value = document.getElementById('input-1').value;
                          alertElement.textContent = ''; // Clear the alert message
                        } else if (paymentTerm === "Due end of the month") {
                          let dueDate;
                          const nextMonth = new Date(invoiceDate.getFullYear(), invoiceDate.getMonth() + 1, 1);
                          dueDate = new Date(nextMonth - 1);
                          const formattedDueDate = dueDate.toISOString().slice(0, 10);
                          dueDateField.value = formattedDueDate;
                          alertElement.textContent = ''; // Clear the alert message
                        } else {
                          // Get the number of days from the selected payment term
                          const days = parseInt(paymentTerm);
                          const dueDate = new Date(invoiceDate);
                          dueDate.setDate(invoiceDate.getDate() + days);
                          const formattedDueDate = dueDate.toISOString().slice(0, 10);
                          dueDateField.value = formattedDueDate;
                          alertElement.textContent = ''; // Clear the alert message
                        }
                      }
                    
                      document.getElementById('input-1').addEventListener('change', function() {
                        calculateDueDate();
                      });
                    
                      document.getElementById('inv_term').addEventListener('change', function() {
                        calculateDueDate(); // Update the due date
                        const alertElement = document.getElementById('alertMessage');
                      });
                    
                      calculateDueDate(); // Calculate the initial due date
                    </script>
                    
                </div>
       

        <div class="row mt-3">
            <div class="container">
                <h4 class="text-white ms-4"></h4>
                <hr class="text-warning">
            </div>
        </div>
       
    
          
<div style="overflow-x:auto;"> 
    <div class="table-responsive">
        <table class="table mt-lg-5 mt-2 rounded" id="invoiceItems" style="background-color: rgb(0, 0, 0);color: white;">
            <thead>
                <tr class="border-bottom border-dark">
                    <th scope="col"><b>index</b></th>
                    <th scope="col"><b>item</b></th>
                    <th scope="col"><b>HSN</b></th>
                    <th scope="col"><b>Quantity</b></th>
                    <th scope="col"><b>Rate</b></th>
                    <th scope="col"><b>Discount</b></th>
                    <th scope="col"><b>Tax</b></th>
                    <th scope="col"><b>Amount</b></th>
                    <th scope="col"><b>remove</b></th>
                </tr>
            </thead>
            <tbody>
                <tr class="border-bottom border-dark"  id='row1'>
                    
                    <td>1</td>
                    <td>
                        <div class="col-md-6 d-flex align-items-center">
                            <div class="search-dropdown-container">
                                <input type="text" id="searchDropdown2" class="search-dropdown" placeholder="Search or select..."  name='item[]' id='item1'>
                                <ul class="dropdown-menu" id="dropdownMenu2">
                                    {% for items in item %}
                                    <a class="dropdown-item item_select itm" onclick="selectItem(this)" value="{{ items.id }}" data-price="{{ items.selling_price }}" data-hsn="{{ items.hsn_code }}">{{items.item_name}}</a>
                                    {% endfor %}
                                </ul>
                            </div>
                            <a class="btn btn-outline-warning ml-2" data-bs-toggle="modal" data-bs-target="#createitem" onclick="openModal()" href="#" role="button">+</a>
                        </div>
                    </td>
                    <td class='text-right'><input type='text' id='hsn1'
                      class='form-control border-0 text-white text-right hsn' name='hsn[]'
                      value=''  >
                    </td>
                    <td class='text-right text-white '><input type='number' id='qty1'
                      class='form-control border-0 text-white text-right qty' name='quantity[]'
                      value='0' onchange="calc()"  >
                    </td>
    
                    <td class='text-right text-white '><input type='number' id='rate1'
                            class='form-control border-0 text-white text-right rate ' name='rate[]'
                            value='0.00' >
                    </td>
                    <td class='text-right text-white '><input type='text' id='desc1'
                            class='form-control border-0 text-white text-right desc' name='desc[]'
                            >
                    </td>
                    <td class='text-right'>
                      <select id="gstPercentageDropdown"  onchange="calculateTotal()" class=' text-right tax ' name='tax[]' style="display: none;">
                      

                          <option>Select Tax</option>
                          <option value="0">GST 0%</option>


                          <option value="5%">GST 5%</option>
                          <option value="12%"> GST 12%</option>
                          <option value="18%">GST 18%</option>
                          <option value="28%"> GST 28%</option>
                      </select>
                      <select id="otherDropdown" class=' text-right tax '>
                        <option>Select Tax</option>
                        <option value="0">IGST 0%</option>


                        <option value="5">IGST 5%</option>
                        <option value="12">IGST 12%</option>
                        <option value="18">IGST 18%</option>
                        <option value="28">IGST 28%</option>
                      </select>
                  </td> 


                    <td class="text-right">
                      <input type="number" class="form-control border-0 text-white text-right amount" id="amount1" name="amount[]" value="0.00" readonly>
                  </td>
                    <td class='text-right'><input type='number' id='amount1'
                            class='form-control border-0 text-black text-right amount' name='amount[]'
                            value='0.00' readonly></td>
                    <td class='text-center'><button type='button' id='del_btn1' onclick="removeRow(this)"
                            class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row'
                            style='width:30px'><i class='fa fa-times'></i></button></td>                   
                </tr>
            </tbody>
        </table>
        
        <button type="button" class="btn btn-success  text-white" style="background-color: rgb(6, 122, 6) ;"
        id="add-row">Add Row</button>
  
    <div class="row border-bottom pb-5">
        <div class="col-sm-6 d-flex flex-column my-auto">
  
            <label for="">Customer Notes</label>
            <textarea name="customer_note" id="" cols="8" rows="8"
                placeholder=" Customer information for future Buisness"></textarea>
        </div>
        <div class="col-sm-6">
            <table class="rounded table  text-white" style="background-color: rgba(51, 50, 48, 0.8);">
                <tr>
                    <td>Sub Total</td>
                    <td></td>
                    <td><input type="number" id="subtotal" name="subtotal" value="0.00"
                            class="form-control border-0 text-right" readonly></td>
                </tr>
                <tr id="tr_igst" >
                    <td>IGST</td>
                    <td></td>
                    <td><input type="number" id='igst' name="igst" value="0.00"
                            class="form-control border-0 text-right" readonly></td>
                </tr>
                <tr   id="tr_cgst">
                    <td>CGST</td>
                    <td></td>
                    <td><input type="number" id='cgst' name="cgst" value="0.00"
                            class="form-control border-0 text-right cgst" readonly></td>
                </tr>
                <tr  id="tr_sgst">
                    <td>SGST</td>
                    <td></td>
                    <td><input type="number" id='sgst' name="sgst" value="0.00"
                            class="form-control border-0 text-right" readonly></td>
                </tr>
                <tr>
                    <td>Tax Amount</td>
                    <td></td>
                    <td><input type="number" id="total_taxamount" name="totaltax" value="0.00"
                            class="form-control border-0 text-right"readonly></td>
                </tr>
               
               
                <tr>
                    <th>Total (&#x20B9;)</th>
                    <th></th>
                    <th><input type="number" id="total_with_tax" name="t_total" value="0.00"
                            class=" form-control border-0 text-right"readonly></b></th>
                </tr>
            </table>
        </div>
    </div>
  
  
    

  
    <div class="" style="margin-bottom: 20rem;">
        <button type="submit" name="sd" class="btn btn-success text-white " 
            value="Save As Draft">Save as Draft</button>
        <button type="submit" name="sd" class="btn btn-warning text-white" 
            value="Save and Send">Save and Send</button>
        <input class="btn btn-danger text-white"
            type="reset" >Cancel</a>
    </div>
  </form>
</div>


</div>

    </div> 
</div>
<script>

// Function to handle item selection
function selectItem(itemElement) {
    var selectedItemId = itemElement.getAttribute("value");
    var selectedHSN = itemElement.getAttribute("data-hsn");
    var selectedRate = itemElement.getAttribute("data-price");

    // Populate fields in the table
    document.getElementById("hsn1").value = selectedHSN;
    document.getElementById("rate1").value = selectedRate;

    // Trigger calculation function
    calculateTotal();
}

// Function to calculate total
function calculateTotal() {
    // Get values from inputs
    var quantity = parseFloat(document.getElementById("qty1").value);
    var rate = parseFloat(document.getElementById("rate1").value);
    var discount = parseFloat(document.getElementById("desc1").value);
    var taxPercentage = parseFloat(document.getElementById("gstPercentageDropdown").value); // or IGST if applicable
    alert(taxPercentage)

    // Perform calculations
    var taxamount = (qty * rate) * (tax / 100);
    var amount = qty * rate;

    var subtotal = quantity * rate;
    var discountAmount = subtotal * (discount / 100);
    var discountedSubtotal = subtotal - discountAmount;
    var taxAmount = discountedSubtotal * (taxPercentage / 100);
    var totalAmount = discountedSubtotal + taxAmount;

    // Update fields with calculated values
    document.getElementById("subtotal").value = subtotal.toFixed(2);
    document.getElementById("total_taxamount").value = taxAmount.toFixed(2);
    document.getElementById("total_with_tax").value = totalAmount.toFixed(2);
}

// Event listeners for input fields
document.getElementById("qty1").addEventListener("input", calculateTotal);
document.getElementById("rate1").addEventListener("input", calculateTotal);
document.getElementById("desc1").addEventListener("input", calculateTotal);
document.getElementById("gstPercentageDropdown").addEventListener("change", calculateTotal);

// You may need to add event listeners for dynamically added rows as well
</script>
   

 


 

<!-- Modal -->
<div class="modal fade bd-example-modal-lg"  id="createitem"tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">

        <div class="modal-content shadow p-3  rounded" style="background-color: rgb(30,30,30);border: 1px solid rgba(255, 255, 255, 0.3);">
            <div class="modal-header" style="background: rgb(32, 35, 37);">
                <h5 class="m-3 text-uppercase"  style="color: #eeeaea;"><b>New Item</b></h5>
                <span class="close" onclick="closeModal()">&times;</span>
              </div>
            <div class="modal-body">
             <br>
              {% for m in messages %}
              <p style="color: chocolate;">{{m}}</p>
              {% endfor %}
      
              <form action="" method="POST" id="add" style="padding-left: 20px;">
                {% csrf_token%}
                <br>  
                <h3 class="mb-3 text-white mt-4" style="font-size: 2rem;"></h3>
                <br>
                <fieldset class="form-group" >
                    <div class="row">
                      <hr>
                     
                        <div class="col-12 col-md-10">
                          <label class="col-12 col-md-2 col-form-label pt-3" style="color: aliceblue;">Type  &nbsp;&nbsp;<i
                            class="fa fa-question-circle"></i></label>
                            <div class="form-check form-check-inline">
                                <input required class="form-check-input" type="radio" name="type" id="gridRadios1" value="Goods">
                                <label class="form-check-label text-white" for="gridRadios1">Goods</label>
                            </div> &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
                            <div class="form-check form-check-inline ml-md-3">
                                <input required class="form-check-input" type="radio" name="type" id="gridRadios2" value="Services">
                                <label class="form-check-label text-white" for="gridRadios2">Services</label>
                            </div>
                        </div>
                    </div>
                </fieldset>
                <br>
                <div class="form-group row">
                    <label  class="col-sm-5 col-form-label " style="color: aliceblue;">Name *</label>
                    <div class="col-sm-10 col-md-7 col-9" style="margin-left: -2.2rem;">
                      <input required type="text" class="form-control" name="name" id="nameInput" style="color: aliceblue;" placeholder="Enter Item Name">  
                    </div>
                  </div>
                  <br>
                  <div class="form-group row">
                    <label class="col-sm-5 col-form-label" style="color: aliceblue;">Unit <i class="fa fa-question-circle"></i></label>
                    <div class="col-sm-10 col-md-7 col-9" style="margin-left: -2.2rem;">
                        <div class="d-flex align-items-center">
                            <select name="unit" class="form-control" id="selunit"  style="background-color: black; color: white;border-radius: 5px;"  >
                              {% for i in units %}
                                <option value={{i.id}}>{{i.unit_name}}</option>
                              {% endfor %}
                            </select>
                            <script>
                              $(document).ready(function() {
                                // Initialize select2
                                $('#selunit').select2();
                              });
                              </script>                        
                               <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js" defer ></script>
            <a class="btn btn-outline-warning py-2" style="cursor: pointer;" data-toggle="modal" data-target="#unitmodal" style="height: 38px; margin-right: 3px;">+</a>
                        </div>
                    </div>
                </div>
                <br>
                <div class="form-group row">
                    <label class="col-sm-5 col-form-label" style="color: aliceblue;">HSN Code</label>
                    <div class="col-sm-10 col-md-7 col-9" style="margin-left: -2.2rem;">
                        <input required type="text" class="form-control" name="hsn" required id="myInputField" style="color: aliceblue;" placeholder="Enter six digit HSN code" oninput="validateInput()">
                        <div id="validationResult"></div>
                    </div>
                </div>
                <br>
                <fieldset class="form-group" >
                    <div class="row">
                  
                        <div class="col-10 col-md-10">
                          <label class="col-12 col-md-2 col-form-label pt-3" style="color: aliceblue;">Tax Preference: &nbsp;&nbsp;</label>
                            <div class="form-check form-check-inline">
                                <input required class="form-check-input" type="radio" name="radio" id="gridRadios1" onclick="showAllSelect()" value="taxable">
                                <label class="form-check-label text-white" for="gridRadios1">Taxable</label>
                            </div> &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
                            <div class="form-check form-check-inline ml-md-3">
                                <input required class="form-check-input" type="radio" name="radio" id="gridRadios2"  onclick="hideAllSelect()" value="None-Taxable">
                                <label class="form-check-label text-white" for="gridRadios2"> None-Taxable</label>
                            </div>
                        </div>
                    </div>
                </fieldset>
              
      <br>
                  <div class="row">
                    <div class="col-md-3">
                  
                      <div id="select1_div" style="display: none;">
                        <label for="select1">Intra-State TAX</label><br> <br>
                        <select name="intra" class="form-control" id="select1" style="background-color: black; color: white;">
                            <option value="0">GST0[0%]</option>
                            <option value="3">GST3[3%]</option>
                            <option value="5">GST5[5%]</option>
                            <option value="12">GST12[12%]</option>
                            <option value="18">GST18[18%]</option>
                            <option value="28">GST28[28%]</option>
                        </select>
                        
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div id="select2_div" style="display: none;">
                        <label for="select2">Inter-State TAX</label> <br><br>
                        <select name="inter" class="form-control " id="select2" style="background-color: black; color: white;">
                          <option value="0">IGST0[0%]</option>
                          <option value="5">IGST3[3%]</option>
                          <option value="5">IGST5[5%]</option>
                          <option value="12">IGST12[12%]</option>
                          <option value="18">IGST18[18%]]</option>
                          <option value="28">IGST28[28%]</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="row">
                    <div class="col-md-6">
                      <input  type="checkbox" name="selling" checked> <label >selling  information</label><br><br>
                      <div class="form-group row">
                        <br>
                        <label class="col-sm-5 col-form-label" style="color: aliceblue;">Selling price </label>
                        <div class="col-sm-12 col-md-7 col-9 ml-5">
                          <div class="input-group mb-2">
                            <div class="input-group-prepend">
                              <div class="input-group-text text-white" style="background-color: black;">INR</div>
                            </div>
                            <input required type="text" name="sel_price" style="color: #ede4e4;" class="form-control">
                          </div>
                        </div>
                      </div>
                      <br>
                      <br>
                      <div class="form-group row">
                        <label  class="col-sm-5 col-form-label" style="color: aliceblue;">Account *</label>
                        <div class="col-sm-10 col-md-7 col-9 ml-5">
                          <select name="sel_acc" class="form-control " style="background-color: black; color: white;">
                            <option value=" ">--Select Account--</option>
                            <option value="General Income">General Income</option>
                            <option value="Interest Income">Interest Income</option>
                            <option value="Late Fee  Income">Late Fee  Income</option>  
                            <option value="Discount Income">Discount Income</option>
                            <option value="Other Charges">Other Charges</option>
                            <option value="Shipping Charge">Shipping Charge</option>
                        
                          </select>                              
                        </div>
                      </div>
                      <br>
                      <br>
                      <div class="form-group row">
                        <label  class="col-sm-5 col-form-label" style="color: aliceblue;">Description </label>
                        <div class="col-sm-10 col-md-7 col-9 ml-5">
                          <input  type="text" style="color: #ede4e4;" name="sel_desc" class="form-control " placeholder="Enter Discription">
                        </div>
                      </div>
                                            
                    </div>
                    <div class="col-md-6">
                      <input type="checkbox" name="purchase" checked> <label for="">Purchase information</label><br><br>
                      <div class="form-group row">
                        <br>
                        <label  class="col-sm-5 col-form-label" style="color: aliceblue;">Cost Price*</label>
                        <div class="col-sm-10 col-md-7 col-9">
                          <div class="input-group mb-2">
                            <div class="input-group-prepend">
                              <div class="input-group-text text-white" style="background-color: black;">INR</div>
                            </div>
                            <input required type="text" style="color: #ede4e4;" class="form-control " name="cost_price" >
                          </div>
                        </div>
                      </div>
                      <br>
                      <div class="form-group row in">
              
                        <label class="col-sm-5 col-form-label" style="color: aliceblue;">Account*</label>
                        <div class="col-sm-10 col-md-7 col-5">
                            <div class="d-flex align-items-center">
                                <select name="cost_acc" class="form-control " id="myaccount" style="color: #fefefe;background-color: #000;" required>
                                  <option value="">--Select Account--</option>
                                  <optgroup id="expensesel" label="Expense">
                             
                                  {% for i in accounts %}
      
                                  {% if i.account_type == 'Expense' %}
                                
                                    <option value="{{i.account_name}}">{{i.account_name}}</option>
                            
                                  {% endif %}
                                  {% endfor %}
                                </optgroup>
                                <optgroup id="costofgoods" label="Cost Of Goods Sold">
                                  {% for i in accounts %}
                                  {% if i.account_type == 'Cost Of Goods Sold' %}
                            
                                    <option value="{{i.account_name}}">{{i.account_name}}</option>
                                    
                                    {% endif %}
                                    {% endfor %}
                                  </optgroup>
                                  <optgroup id="otherexpensesel" label="Other Expense">
                                  {% for i in accounts %}
                                  {% if i.account_type == 'Other Expense' %}
                            
                                    <option value="{{i.account_name}}">{{i.account_name}}</option>
                                    
                                    {% endif %}
                                    {% endfor %}
                                  </optgroup>
                      
                                 
                              
                                </select>
                                <script>
                                  $(document).ready(function() {
                                    // Initialize select2
                                    $('#myaccount').select2();
                                  });
                                  </script>                        
                                   <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js" defer ></script>
                                <a class="btn btn-outline-warning py-2" style="cursor: pointer;" data-toggle="modal" data-target="#account" style="height: 38px; margin-right: 3px;">+</a>
         
                            </div>
                           
                        </div>
                    </div>
                    <br>
                    <div class="form-group row in">
                        <label class="col-sm-5 col-form-label" style="color: aliceblue;">Description</label>
                        <div class="col-sm-10 col-md-7 col-5">
                            <div class="d-flex align-items-center">
                                <input  type="text" style="color: #ede4e4;" name="pur_desc" class="form-control " placeholder="Enter Discription">
                            </div>
                        </div>
                    </div>
                    </div>
                    </div>
                    <br>     <br>
                    <div class="form-group row text-center">
                        <label class="col-sm-5 col-form-label" style="color: aliceblue;">Minimum Stock to maintain :</label>
                        <div class="col-sm-10 col-md-7 col-9 d-flex align-items-center" style="margin-left: -2.2rem;">
                          <input type="number" style="color: #ede4e4;" name="minimum_stock" class="form-control mx-auto" placeholder="Enter Minimum Stock">
                        </div>
                      </div>
                      <br>
                     
                    <br><br>     
                    <div class="row" >
                      <div class="col-md-10">
                        {% comment %} <label style="color: aliceblue;"><input type="checkbox" value="trackstate" name="trackstate" onclick="toggleForm()" style="display: none;">
                       Track Inventory for this item</label> {% endcomment %}
                        <!-- {% comment %} <input type="checkbox" name="trackState" id="trackStateCheckbox">{% endcomment %} -->
                        <label style="color: aliceblue;">
                       
                          <input type="checkbox" name="trackstate" class=" "  onclick="toggleFormFields()">
                          Track Inventory for this item
                        </label>   <br>   <br>
                        <div id="formFields" style="display: none;"> 
                          <div class="form-group row" >
                            <label class="col-sm-2 col-form-label" style="color: aliceblue;">Inventory Account *</label>
                            <div class="col-sm-10 col-md-7 col-9" style="margin-left: -1rem;">
                              <select class="form-select form-select-sm mt-3 " name="invacc" style="background-color: black; color: white;">
                                <option value="">Choose..</option>
                                <option value="inventory assets">Inventory Asset</option>
                              </select>
                            </div>
                          </div>
                          <br>
                          <div class="form-group row ">
                            <label class="col-sm-2 col-form-label" style="color: aliceblue;">Opening Stock</label>
                            <div class=" col-md-5">
                              <input  type="number" style="color: #ede4e4;" class="form-control "  name="openstock" value="0">
                            </div>
                            </div>
                            <br>
                            <div class="form-group row ">
                                <label class="col-sm-2 col-form-label" style="color: aliceblue;">Opening Stock Rate per Unit</label>
                                <div class=" col-md-5">
                                    <input type="number" style="color: #ede4e4;" class="form-control" name="rate"  value="0">
                                </div>
                                </div>
      
                          </div>
                        </div>
                      </div>
                      
                    <div class="form-inline " style="margin-bottom: 200px;padding-bottom: 20px;">
                        <button type="submit"  class="mr-3 btn" style="background-color: chocolate;color: aliceblue;" value="Save">Save</button>
                        <button type="button" class="mr-3 btn" onclick="resetForm()" value="Cancel" style="margin-left:10px;background-color: chocolate;color: aliceblue;">Cancel</button>
                      </div>   
                      
                      <div class="form-inline " style="margin-bottom: 200px;"></div>
                      <div class="form-inline " style="margin-bottom: 200px;"></div>
                      <div class="form-inline " style="margin-bottom: 200px;"></div>
            </form>
            </div>
            </div>
            </div>
            
            {% comment %} <div id="total-bill-amount" class="mt-3" style="color: white;"></div> {% endcomment %}
            <div>
                <div id="noDataMessage" style="display: none; color: white;">No data found for selected dates.</div>	
                <br><br><br><br><br>
            </div>
        
      </div>
      <div class="form-inline " style="margin-bottom: 200px;"></div>                <div class="form-inline " style="margin-bottom: 200px;"></div>
      
      
      </div>
                    
      <div class="modal fade bd-example-modal-lg"id="createcustomer" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content shadow p-3  rounded" style="background-color: rgb(30,30,30);border: 1px solid rgba(255, 255, 255, 0.3);">
                <div class="modal-header" style="background: rgb(32, 35, 37);">
                    <h5 class="m-3 text-uppercase" id="shareBillEmailLabel" style="color: #eeeaea;"><b>New Customer</b></h5>
                    <span class="close" onclick="closeModal2()">&times;</span>
                  </div>
                <div class="modal-body">
              <form action="" method="POST" enctype="multipart/form-data"
                style="color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                {% csrf_token %}
        
                <label for="name">Customer Type </label>
                &nbsp;&nbsp;&nbsp;
        
                <input type="radio" id="Business" name="type" value="Business">
                <label for="Business"> Business</label>
                &nbsp;&nbsp;&nbsp;
                <input type="radio" id="Individual" name="type" value="Individual">
                <label for="Individual"> Individual</label><br>
                <span class="input-group mb-3 mt-3">
        
        
                  <label for="foname">Primary Contact:</label>
                  &nbsp;&nbsp;&nbsp;
                  <select name="txtsalu" id="sa">
                    <option value="Mr." selected>Mr.</option>
                    <option value="Mrs.">Mrs.</option>
                    <option value="Ms.">Ms.</option>
                    <option value="Miss.">Miss.</option>
                    <option value="Dr.">Dr.</option>
                  </select>&nbsp;&nbsp;&nbsp;
        
                  <input type="text" id="fName" />&nbsp;&nbsp;&nbsp;
                  <input type="text" id="lName" oninput="generateFullName()" />
                  <br>
                </span>
                <label
                  style="color: rgb(214, 75, 75) ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">Customer
                  Display Name* </label>
                &nbsp;&nbsp;&nbsp;
                <input type="text" id="txtFullName" name="txtFullName"><br><br>
        
        
        
                <label for="name"
                  style="color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">Company
                  Name </label>
                &nbsp;&nbsp;&nbsp;
                <input type="text" id="ccname" name="cpname">
                &nbsp;&nbsp;&nbsp;<br><br>
        
        
        
                <label for="name"
                  style="color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">Customer
                  Email </label>
                &nbsp;&nbsp;&nbsp;
                <input type="email" id="myEmail" name="email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$">
                <br>
                <span class="input-group mb-3 mt-3">
                  <label for="name"
                    style="color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">Customer
                    Phone </label>
                  &nbsp;&nbsp;&nbsp;
        
                  <input type="text" id="fname" name="fname" placeholder="Work Phone">&nbsp;&nbsp;&nbsp;
                  <br>

                  <input type="text" id="lname" name="lname" placeholder="Mobile">&nbsp;&nbsp;&nbsp;
                  <br>
                  <div class="toggle"
                    style=" color: rgb(230, 171, 45);;font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                    Add more details </div>
                </span><br>
        
        
        
        
                <fieldset1 class="contact"
                  style="display:none;color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                  <div class="col-sm-10 form-inline">
                    <label for="name">Skype Name/Number </label> &nbsp;&nbsp;&nbsp;
                    <input type="text" id="cn" name="lna">&nbsp;&nbsp;&nbsp;<br>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name">Designation </label> &nbsp;&nbsp;&nbsp;
                    <input type="text" id="cn" name="lna">&nbsp;&nbsp;&nbsp;<br>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name">Department </label> &nbsp;&nbsp;&nbsp;
                    <input type="text" id="cn" name="lna">&nbsp;&nbsp;&nbsp;<br>
                  </div><br>
                </fieldset1>
        
        
        
                <label for="name"
                  style="color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                  Website
                </label>
                &nbsp;&nbsp;&nbsp;
                <input type="text" id="cn" name="wbsite">
                &nbsp;&nbsp;&nbsp;<br>
        
                <span class="input-group mb-3 mt-3">
                  <div class="toggle2"
                    style="color: rgb(230, 171, 45);font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                    Other Details </div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  <div class="toggle3"
                    style="color: rgb(230, 171, 45);font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                    Address</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  <div class="toggle4"
                    style="color: rgb(230, 171, 45);font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                    Contact persons</div>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                 
                  <div class="toggle7"
                    style="color: rgb(230, 171, 45);font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                    Remarks</div>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                </span>
        
                <fieldset2 class="other details"
                  style="display:none;color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                  <div class="col-sm-10 form-inline">
                    <label for="name"
                      style="color: rgb(214, 75, 75) ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                      GST Treatment* </label>
                    &nbsp;&nbsp;&nbsp;
        
                    <select name="gstt" id="GSTT" Style="min-width: 150px;
                    max-width: 300px;">
                      <option Style="min-width: 150px;
                    max-width: 300px;font-size: 12px;" value="value" selected>Select a Gst Treatment</option>
                      <option Style="min-width: 150px;
                      max-width: 300px;font-size: 12px;" value="Registered Business-Regular Business that is registered under GST">Registered
                        Business-Regular Business that is registered under GST</option>
                      <option Style="min-width: 150px;
                      max-width: 300px;font-size: 12px;" value="Registered Business-Composition Business that is registered under the Composition scheme
                              in GST">Registered Business-Composition Business that is registered under the Composition scheme
                        in GST</option>
                      <option Style="min-width: 150px;
                      max-width: 300px;font-size: 12px;" value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under
                        GST</option>
                      <option Style="min-width: 150px;
                      max-width: 300px;font-size: 12px;" value="Consumer- A customer who is a regular Consumer">Consumer- A customer who is a regular
                        Consumer</option>
                      <option Style="min-width: 150px;
                      max-width: 300px;font-size: 12px;" value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas-
                        Persons with who you do import or exports of supplies outside india</option>
                      <option Style="min-width: 150px;
                      max-width: 300px;font-size: 12px;" value="Special Economic Zone">Special Economic Zone</option>
                    </select><br>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name"
                      style="color: rgb(214, 75, 75) ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                      Place Of Supply* </label>
                    &nbsp;&nbsp;&nbsp;
        
                    <select name="posply" id="PLACE">
                      <option value="value" selected></option>
                      <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option>
                      <option value="volvo">[AD]-Andhra Pradesh</option>
                      <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh </option>
                      <option value="volvo">[AS]-Assam</option>
                      <option value="[BR]-Bihar">[BR]-Bihar</option>
                      <option value="volvo">[CH]- Chandhigarh</option>
                      <option value="volvo">[CG]- Chattisgarh</option>
                      <option value="[DD]-	Daman Diu">[DD]- Daman Diu</option>
                      <option value="volvo">[DL]- Delhi</option>
                      <option value="volvo">[GA]-Goa</option>
                      <option value="volvo">[GJ]-Gujarat</option>
                      <option value="[HR]-Haryana">[HR]-Haryana</option>
                      <option value="volvo">[HP]-Himachal Pradesh</option>
                      <option value="[JK]-	Jammu And Kashmir">[JK]- Jammu And Kashmir</option>
                      <option value="volvo">[JH]-Jharkand</option>
                      <option value="[KA]-Karnataka">[KA]-Karnataka</option>
                      <option value="volvo">[KL]-Kerala</option>
                      <option value="[LA]-Ladakh">[LA]-Ladakh</option>
                      <option value="volvo">[LD]-Lakshadweep</option>
                      <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option>
                      <option value="volvo">[MH]-Maharashtra</option>
                      <option value="[MN]-Manipur">[MN]-Manipur</option>
                      <option value="volvo">[ML]-Meghalaya</option>
                      <option value="[MZ]-Mizoram">[MZ]-Mizoram</option>
                      <option value="volvo">[NL]-Nagaland</option>
                      <option value="volvo">[NL]-Nagaland</option>
                      <option value="[OD]-Odisha">[OD]-Odisha</option>
                      <option value="volvo">[PY]-Puducherry</option>
                      <option value="[PB]-Punjab">[PB]-Punjab.</option>
                      <option value="audi">[RL]-Rajasthan</option>
                      <option value="[SK]-Sikkim">[SK]-Sikkim</option>
                      <option value="audi">[TN]-Tamilnadu</option>
                      <option value="[TS]-Telenghana">[TS]-Telenghana</option>
                      <option value="audi">[TR]-Tripura</option>
                      <option value="audi">[UP]-Uttar Pradesh</option>
                      <option value="[UK]-Utharakhand">[UK]-Utharakhand</option>
                      <option value="audi">[WB]-West Bengal</option>
                      <option value="[OT]-Other Territory">[OT]-Other Territory</option>
                    </select>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name"
                      style="color: rgb(214, 75, 75) ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                      Tax Preference* </label>
                    &nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;
        
                    <input type="checkbox" id="Taxable" name="tax1" value="Taxable">
                    <label for="vehicle1">Taxable</label>
                    &nbsp;&nbsp;&nbsp;
                    <input type="checkbox" id="Tax Exempt" name="tax1" value="Tax Exempt">
                    <label for="vehicle2"> Tax Exempt</label>
        
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name"
                      style="color: rgb(214, 75, 75) ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                      Currency* </label>
                    &nbsp;&nbsp;&nbsp;
        
                    <select name="crncy" id="PLACE">
                      <option value="value" selected>Indian Rupee</option>
                      <option value="volvo">Indian Rupee</option>
        
                    </select>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name"> Opening Balance</label> &nbsp;&nbsp;&nbsp;
                    <input type="number" id="cn" name="obal">&nbsp;&nbsp;&nbsp;<br>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name"
                      style="color: white; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                      Payment Terms </label>
                    &nbsp;&nbsp;&nbsp;
        
                    <select name="pterms" id="PLACE">
        
        
                      {% for cs in sb %}
        
                      <option type="text" value='{{ cs.id }}'> {{ cs.Terms}}</option>
                      {% endfor %}
                    </select>
                    <div type="button" onclick="openpop()"
                      style="color: rgb(230, 171, 45);font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                      Configure terms</div>
                  </div><br>
        
        
        
        
                  <div class="col-sm-10 form-inline">
                    <label for="name"
                      style="color: white; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                      Price List </label>
                    &nbsp;&nbsp;&nbsp;
        
                    <select name="plst" id="PLACE">
                      <option>select</option>
                      <option value="Price Book0 [69% Markup]">Price Book0 [69% Markup]</option>
                      <option value="Price Book1 [3]5% Markdowm">Price Book1 [3]5% Markdowm</option>
                    </select>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name">Enable Portal?</label> &nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;
        
                    <input type="checkbox" id="vehicle1" name="vehicle1" value="Bike">
                    <label for="vehicle1">Allow Prtal Access For This Customer</label>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name"
                      style="color: white; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                      Portal Language</label>
                    &nbsp;&nbsp;&nbsp;
        
                    <select name="plang" id="PLACE">
                      <option>select</option>
                      <option value="ENGLISH">ENGLISH</option>
        
                    </select>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name">Facebook </label> &nbsp;&nbsp;&nbsp;
                    <input type="text" id="cn" name="fbk" placeholder="Facebook">&nbsp;&nbsp;&nbsp;<br>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <label for="name">Twitter</label> &nbsp;&nbsp;&nbsp;
                    <input type="text" id="cn" name="twtr" placeholder="Twitter">&nbsp;&nbsp;&nbsp;<br>
                  </div><br>
                  <label>Customer Owner: Assign a user as the Customer owner to provide access only to the data of this
                    customer.
                  </label>
                </fieldset2>
        
        
                <fieldset3 class="address"
                  style="display:none;color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                  <div style="float: left;">
                    <div class="col-sm-10 form-inline">
                      <label>Billing Address</label>
                    </div><br>
        
                    <div class="col-sm-10 form-inline">
                      <label for="name">Attention </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="batn" name="atn">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
        
                    <div class="col-sm-10 form-inline">
                      <label for="name"
                        style="color: white; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                        Country</label>
                      &nbsp;&nbsp;&nbsp;
        
                      <select name="ctry" id="bcty">
                        <option value="value" selected>India</option>
                        <option value="volvo">India</option>
                      </select>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">Address </label> &nbsp;&nbsp;&nbsp;
                      <textarea type="text" id="bads1" name="addrs"> </textarea><br><br>
                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<textarea type="text" id="bads2"
                        name="addrs1">&nbsp;&nbsp;&nbsp; </textarea><br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">City</label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="bct" name="bct">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">State </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="bst" name="bst">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">Zip Code </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="bzip" name="bzip">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">Phone </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="bpon" name="bpon">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">Fax </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="bfx" name="bfx">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                  </div>
                  <div style="float: left;">
                    <div class="col-sm-10 form-inline">
                      <label>shippiing Address</label>
                    </div>
                    <div class="col-sm-10 form-inline">
                      <input type="checkbox" id="myCheckT" onclick="myCopyAddressFunction()">&nbsp;
                      <label for="myCheck">Same as Billing Address:</label>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">Attention </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="satn" name="lna">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name"
                        style="color: white; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                        Country</label>
                      &nbsp;&nbsp;&nbsp;
        
                      <select name="Place" id="scty">
                        <option value="value" selected>India</option>
                        <option value="volvo">India</option>
        
                      </select>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">Address </label> &nbsp;&nbsp;&nbsp;
                      <textarea type="text" id="sads1" name="lna">&nbsp;&nbsp;&nbsp; </textarea><br><br>
                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<textarea type="text" id="sads2"
                        name="lna">&nbsp;&nbsp;&nbsp; </textarea><br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">City</label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="sct" name="lna">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">State </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="sst" name="lna">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">Zip Code </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="szip" name="lna">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">Phone </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="spn" name="lna">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                    <div class="col-sm-10 form-inline">
                      <label for="name">Fax </label> &nbsp;&nbsp;&nbsp;
                      <input type="text" id="sfx" name="bfx">&nbsp;&nbsp;&nbsp;<br>
                    </div><br>
                  </div>
                  <div class="col-sm-10 form-inline">
                    <label></label>
                  </div><br>
                </fieldset3><br>
                <fieldset5 class="contact persons"
                  style="display:none;color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:10px;">
                  <table id="tbl" style="border:1px solid;border-color:white;width:50%; max-height: 300px; max-width: 3px;
                  overflow-y: auto">
                    <tr>
                      <th>Salutation</th>
                      <th>First Name</th>
                      <th>Last Name</th>
                      <th>Email Address</th>
                      <th>Work Phone</th>
                      <th>Mobile</th>
                      <th>Skype Name/Number</th>
                      <th>Designation</th>
                      <th>Department</th>
                    </tr>
                    <tr>
                      <td><select name="sal" id="PLACE">
                          <option value="Mr." selected>Mr.</option>
                          <option value="Mrs.">Mrs.</option>
                          <option value="Ms.">Ms.</option>
                          <option value="Miss.">Miss.</option>
                          <option value="Dr.">Dr.</option>
                        </select></td>
                      <td><input type="text" name="ftname" /></td>
                      <td><input type="text" name="ltname" /></td>
                      <td><input type="text" name="mail" /></td>
                      <td><input type="text" name="bworkpn" /></td>
                      <td><input type="text" name="bmobile" /></td>
                      <td><input type="text" name="bskype" /></td>
                      <td><input type="text" name="bdesg" /></td>
                      <td><input type="text" name="bdept" /></td>
                    </tr>
                  </table>
                  <div class="button add_another"
                    style="color: rgb(230, 171, 45);;font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                    + Add Contact Person</div>
        
                </fieldset5>
        
        
        
                
                <fieldset7 class="Remarks"
                  style="display:none;color: azure ; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;font-size:22px;">
                  <textarea type="text" id="rmks" name="rmrks"></textarea>
                </fieldset7><br>
        
                <div style="margin-bottom: 10rem;" class="col-sm-10 form-inline">
                  <input type="submit" style=" float:none;" value="Submit">&nbsp;&nbsp;
                  <input type="reset" value="Cancel"></button>
                </div><br>
              </form>
            </div>
          </div>
              <div  class="popup-0" id="popup-0" style="background-color:white;">
                <div style="background-color:white;" class="display-flex;">
                  <h4 style="color: black;">Configure terms</h4>
                  <h6 class="float-right text-white" style="margin-right: 1rem; margin-top: -2rem;color:rgb(8, 8, 8);background-color: black;"
                    onclick="closepop()">X</h6>
                </div>
        
        
                <form style="" action="" method="post">
                  {% csrf_token %}
                  <div class="col-sm-10 form-inline">
                    <label style="color: black;" for="name">Term Name</label> &nbsp;&nbsp;&nbsp;
                    <input type="text" id="termk" name="term"><br>
                  </div><br><br>
                  <div class="col-sm-10 form-inline">
                    <label style="color: black;"  for="name">Number of days</label>
                    <input type="number" id="term" name="day"><br>
                  </div><br>
                  <div class="col-sm-10 form-inline">
                    <input type="submit" class="mr-3 btn btn-success" value="Save">&nbsp;&nbsp;&nbsp;
                    <input type="reset" value="Cancel"  onclick="closepop()"></button>
                  </div><br>
                </form>
              </div>
        
            
        
        
        
        
            <script>
              function generateFullName() {
                document.getElementById('txtFullName').value =
                  document.getElementById('sa').value +
                  document.getElementById('fName').value + ' ' +
                  document.getElementById('lName').value;
        
              }
              function myFunction() {
                var x = document.getElementById("myEmail").pattern;
                document.getElementById("demo").innerHTML = x;
              }
              function myCopyAddressFunction() {
                var checkBox = document.getElementById("myCheckT");
                var textatn = document.getElementById("batn");
                var txtcry = document.getElementById("bcty");
                var txtadrs11 = document.getElementById("bads1");
                var txtadrs12 = document.getElementById("bads2");
                var txtcty = document.getElementById("bct");
                var txtstat = document.getElementById("bst");
                var txtzip = document.getElementById("bzip");
                var txtphone = document.getElementById("bpon");
                var txtfx = document.getElementById("bfx");
        
                var textatn1 = document.getElementById("satn");
                var txtcry1 = document.getElementById("scty");
                var txtadrs21 = document.getElementById("sads1");
                var txtadrs22 = document.getElementById("sads2");
                var txtcty1 = document.getElementById("sct");
                var txtstat1 = document.getElementById("sst");
                var txtzip1 = document.getElementById("szip");
                var txtphone1 = document.getElementById("spn");
                var txtfx1 = document.getElementById("sfx");
                if (checkBox.checked == true) {
                  textatn1.value = textatn.value;
                  txtcry1.value = txtcry.value;
                  txtadrs21.value = txtadrs11.value;
                  txtadrs22.value = txtadrs12.value;
                  txtcty1.value = txtcty.value;
                  txtstat1.value = txtstat.value;
                  txtzip1.value = txtzip.value;
                  txtphone1.value = txtphone.value;
                  txtphone1.value = txtfx.value;
        
                } else {
                  textatn1.value = "";
                  txtcry1.value = "";
                  txtadrs21.value = "";
                  txtadrs22.value = "";
                  txtcty1.value = "";
                  txtstat1.value = "";
                  txtzip1.value = "";
                  txtphone1.value = "";
                  txtphone1.value = "";
        
                }
              }
              $(document).ready(function () {
                $(".toggle").click(function (e) {
                  e.preventDefault();
                  $("fieldset1").toggle();
                })
              })
              $(document).ready(function () {
                $(".toggle2").click(function (e) {
                  e.preventDefault();
                  $("fieldset2").toggle();
                })
              })
              $(document).ready(function () {
                $(".toggle3").click(function (e) {
                  e.preventDefault();
                  $("fieldset3").toggle();
                })
              })
              $(document).ready(function () {
                $(".toggle4").click(function (e) {
                  e.preventDefault();
                  $("fieldset5").toggle();
                })
              })
              $(document).ready(function () {
                $(".toggle6").click(function (e) {
                  e.preventDefault();
                  $("fieldset6").toggle();
                })
              })
              $(document).ready(function () {
                $(".toggle7").click(function (e) {
                  e.preventDefault();
                  $("fieldset7").toggle();
                })
              })
              $(document).ready(function () {
                $(".toggle9").click(function (e) {
                  e.preventDefault();
                  $("fieldset9").toggle();
                })
              })
              $('document').ready(function () {
                $('.add_another').click(function () {
                  $("#tbl").append('<tr><td><select name="Place" id="PLACE"><option value="value" selected>Mr.</option><option value="volvo">Mrs.</option><option value="saab">Ms.</option><option value="mercedes">Miss.</option><option value="audi">Dr.</option></select>  </td><td><input type="text" class="txtbox" value="" /></td><td><input type="text" class="txtbox" value="" /></td><td><input type="text" class="txtbox" value="" /></td><td><input type="text" class="txtbox" value="" /></td><td><input type="text" class="txtbox" value="" /></td><td><input type="text" class="txtbox" value="" /></td><td><input type="text" class="txtbox" value="" /></td><td><input type="text" class="txtbox" value="" /></td></tr>');
                });
              })
        
              let popu = document.getElementById("popup-0");
        
              function openpop() {
                popu.classList.add("open-popup-3");
              }
              function closepop() {
                popu.classList.remove("open-popup-3");
              }
            </script>
          </div>
          </div>
        </div>
               
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"></script>
<script>
    const registrationTypeSelectEls = document.querySelectorAll('.registration-type');
    const registrationModalEls = document.querySelectorAll('.registration-modal');
    const openModalBtnEls = document.querySelectorAll('.open-modal-btn');
    const closeBtnEls = document.querySelectorAll('.close-btn');

    for (let i = 0; i < openModalBtnEls.length; i++) {
        openModalBtnEls[i].addEventListener('click', () => {
            // Open the modal corresponding to the button clicked
            registrationModalEls[i].style.display = 'block';
        });
    }

    for (let i = 0; i < closeBtnEls.length; i++) {
        closeBtnEls[i].addEventListener('click', () => {
            // Close the modal corresponding to the close button clicked
            registrationModalEls[i].style.display = 'none';
        });
    }

    window.addEventListener('click', (event) => {
        // Close modal if clicked outside the modal
        for (let i = 0; i < registrationModalEls.length; i++) {
            if (event.target === registrationModalEls[i]) {
                registrationModalEls[i].style.display = 'none';
            }
        }
    });
</script>
      <script>
        function openModal() {
            document.getElementById("createitem").style.display = "block";
          }
        function closeModal() {
        document.getElementById("createitem").style.display = "none";
        window.location.href = "http://127.0.0.1:8000/Staff/invoice/create";

      }
    </script>
    <script>
        function openModal2() {
            document.getElementById("createcustomer").style.display = "block";
          }
        function closeModal2() {
        document.getElementById("createcustomer").style.display = "none";
        window.location.href = "http://127.0.0.1:8000/Staff/invoice/create";

      }
    </script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var searchDropdown = document.getElementById("searchDropdown");
        var dropdownMenu = document.getElementById("dropdownMenu");

        searchDropdown.addEventListener("input", function() {
            if (this.value.trim() !== "") {
                dropdownMenu.classList.add("show");
            } else {
                dropdownMenu.classList.remove("show");
            }
        });

        dropdownMenu.addEventListener("click", function(e) {
            var target = e.target;
            if (target && target.matches(".dropdown-item")) {
                searchDropdown.value = target.textContent;
                dropdownMenu.classList.remove("show");
            }
        });

        // Close dropdown menu when clicking outside
        document.addEventListener("click", function(e) {
            if (!searchDropdown.contains(e.target) && !dropdownMenu.contains(e.target)) {
                dropdownMenu.classList.remove("show");
            }
        });
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var searchDropdown = document.getElementById("searchDropdown");
        var dropdownMenu = document.getElementById("dropdownMenu");

        searchDropdown.addEventListener("input", function() {
            if (this.value.trim() !== "") {
                dropdownMenu.classList.add("show");
            } else {
                dropdownMenu.classList.remove("show");
            }
        });

        dropdownMenu.addEventListener("click", function(e) {
            var target = e.target;
            if (target && target.matches(".dropdown-item")) {
                searchDropdown.value = target.textContent;
                dropdownMenu.classList.remove("show");
            }
        });

        // Close dropdown menu when clicking outside
        document.addEventListener("click", function(e) {
            if (!searchDropdown.contains(e.target) && !dropdownMenu.contains(e.target)) {
                dropdownMenu.classList.remove("show");
            }
        });
    });
</script>
      
<!-- Include this script after your HTML content -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var dropdownMenu = document.getElementById('dropdownMenu2');
        var searchDropdown = document.getElementById('searchDropdown2');

        // Event listener for clicking on dropdown items
        dropdownMenu.addEventListener('click', function(event) {
            var target = event.target;
            if (target.classList.contains('dropdown-item')) {
                // Set the value of the search dropdown input to the selected item
                searchDropdown.value = target.textContent;
            }
        });

        // Event listener for clicking on the search dropdown input
        searchDropdown.addEventListener('click', function() {
            // Show the dropdown menu when the search dropdown input is clicked
            dropdownMenu.style.display = 'block';
        });

        // Event listener for typing in the search dropdown input
        searchDropdown.addEventListener('input', function() {
            var filter = searchDropdown.value.toUpperCase();
            var items = dropdownMenu.getElementsByTagName('li');

            // Loop through all dropdown items, and hide those that do not match the search input
            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                if (item.textContent.toUpperCase().indexOf(filter) > -1) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            }
        });

        // Close the dropdown menu when clicking outside of it
        window.addEventListener('click', function(event) {
            if (!event.target.matches('.search-dropdown')) {
                dropdownMenu.style.display = 'none';
            }
        });
    });
</script>
$(document).ready(function() {
  // add event listener to trigger calc() function whenever a change is made to input fields
  $('#invoiceItems').on('input', 'input', calc);
});

function calc() {
  // loop through each row in the table
  $('#invoiceItems tbody tr').each(function() {
      // get the values of the input fields for this row
      var qty = $(this).find('.qty').val();
      var rate = $(this).find('.rate').val();
      var desc = $(this).find('.desc').val();
      var tax = $(this).find('.tax').val();
      var quantity = parseFloat(document.getElementById("qty1").value);
      var rate = parseFloat(document.getElementById("rate1").value);
      var discount = parseFloat(document.getElementById("desc1").value);
      var taxPercentage = parseFloat(document.getElementById("gstPercentageDropdown").value);
      alert("ok")
      
      // calculate the tax amount and total amount for this row
      var taxamount = (qty * rate) * (tax / 100);
      var amount = qty * rate;
      
      // update the tax amount and total amount input fields for this row
      $(this).find('.taxamount').val(taxamount.toFixed(2));
      $(this).find('.amount').val(amount.toFixed(2));
  });
  
  // calculate the total amount and total tax amount for all rows
  var total = 0;
  var taxamount = 0;
  $('.amount').each(function() {
      total += parseFloat($(this).val());
  });
  $('.taxamount').each(function() {
      taxamount += parseFloat($(this).val());
  });
  
  // update the subtotal and total tax amount input fields
  $('#subtotal').val(total.toFixed(2));
  $('#total_taxamount').val(taxamount.toFixed(2));

  var total_with_tax = total + taxamount;
  
  // display the total amount including tax on the page
  $('#total_with_tax').val(total_with_tax.toFixed(2));

test(taxamount);

}

// Update subtotal when a row is deleted
  $(document).ready(function dlt () {
      $('#item_table').on('click', '.delete-row', function () {
          var tr = $(this).closest('tr');
          var taxamount= parseFloat(tr.find('input[name^="taxamount"]').val());
          var amount = parseFloat(tr.find('input[name^="amount"]').val());
          var subtotal = parseFloat($('#subtotal').val());

          var total_taxamount = parseFloat($('#total_taxamount').val());
          $('#total_taxamount').val((total_taxamount-taxamount).toFixed(2));

          $('#subtotal').val((subtotal - amount).toFixed(2));

          var total_with_tax= parseFloat($('#total_with_tax').val());
          $('#total_with_tax').val((total_with_tax  - amount - taxamount).toFixed(2));
          
          var pos = $("#customer_sel option:selected").data("pos");
          var state = document.getElementById("state").value;
          d=0
          if(pos==state){
              
              gst = taxamount / 2;
          console.log(gst);
          $('#cgst').val(parseFloat(gst.toFixed(2)));
          $('#sgst').val(parseFloat(gst.toFixed(2)));
          $('#igst').val(parseFloat(d.toFixed(2)));

          var cgst= parseFloat($('#cgst').val());
          $('#cgst').val(( taxamount-cgst ).toFixed(2));
          var sgst= parseFloat($('#sgst').val());
          $('#sgst').val(( taxamount-sgst ).toFixed(2));
         
          }
          if(pos!=state){
             
          console.log(gst);
          $('#cgst').val(parseFloat(d.toFixed(2)));
          $('#sgst').val(parseFloat(d.toFixed(2)));
          $('#igst').val(parseFloat(taxamount.toFixed(2)));

         
          var igst= parseFloat($('#igst').val());
          $('#igst').val(( total_taxamount-igst ).toFixed(2));
         
          }
         
         

          tr.remove();
          
          
      });
  });




{% endblock %}